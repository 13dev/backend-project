const { Malware } = require('../models');
module.exports = new class MalwareController {
    index(request, response, next) {
        Malware
            .findAll()
            .then(result => response.formatter.ok(result))
            .catch(result => response.formatter.serverError(result));

    }
    //TO FIND A CERTAIN MALWARE
    findMalware(request, response, next) {
        Malware.findOne({
            where: { name: request.params.malwareName }
        })
            .then((result) => response.formatter.ok(result))
            .catch((result) => response.formatter.serverError(result));
    }
    //TO CREATE A MALWARE
    createMalware(request, response, next) {
        Malware.create({
            user_id: request.body.user_id,
            name: request.body.name,
            dangerLevel: request.body.dangerLevel,
            description: request.body.description,
            type: request.body.type,
            active: request.body.active,
            createAt: new Date(),
            updatedAt: new Date()
        })
            .then((result) => response.formatter.ok(result))
            .catch((result) => response.formatter.serverError(result));
    }
    //TO UPDATE A MALWARE
    updateMalware(request, response, next) {
        Malware.update({
            user_id: request.body.user_id,
            name: request.body.name,
            dangerLevel: request.body.dangerLevel,
            description: request.body.description,
            type: request.body.type,
            active: request.body.active,
            createAt: new Date(),
            updatedAt: new Date()
        }, { where: { id: request.params.id } })
            .then((result) => response.formatter.ok(result))
            .catch((result) => response.formatter.serverError(result));
    }
    deleteMalware(request, response, next) {
        Malware.destroy({ where: { id: request.params.id } })
            .then((result) => response.formatter.ok(result))
            .catch((result) => response.formatter.serverError(result));
    }
};